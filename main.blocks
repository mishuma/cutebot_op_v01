<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="U2|dP3WM^{Av(2(!truy">d</variable><variable id="1^cABJ;?ZY9D~*9KifSt">t</variable><variable id="YyDLo+sh[Rz^a;{fQ+R%">s</variable><variable id="U$d?zis}dPlDI|?^Uw6d">parts</variable><variable id="/iD:t/KtoLmpvkZq,?0[">op</variable><variable id="zC|f_%hDhg7a*Yp+w67t">u</variable><variable id="@FRdwCL/#3IkqkK{)R_;">parts2</variable><variable id="ZEz^f.v~QRCR:{A#!(tK">seqHex</variable><variable id="#)=`]V=rN0xlmymZDi5M">op2</variable><variable id="PReV_rbxy+a?${h?X6,Q">raw</variable><variable id="bFk@v:a#+pO,$T`.7%tw">line</variable><variable id="COWuc3TIE?60EW4X+#S,">cmd</variable><variable id="Z-TiCE@J_1c@9n4ab7[W">opGuess</variable></variables><comment id="{tUwNok3_#tf?gm$?QjA" x="4127.4296875" y="2985" w="480" h="360">
===== Cutebot + BLE UART (Immediate Exec, '!' delimiter, descriptive ACKs + ECHO) =====

Command sent from app (terminate each with '!'):
:SEQ,OP,ARGS*!
SEQ = 2 hex digits (00..FF)
OP  = MV|SP|TL|TR|BK|HL|BZ|EC

ARGS (hex bytes 00..FF):
MV,left,right         -&gt; motors(left,right) 0..100 (negatives reverse)
SP,00                 -&gt; stop immediately
TL,00 / TR,00         -&gt; turn left/right (icons shown)
BK,ss                 -&gt; backward via motors(-ss,-ss); default 50
HL,01|00              -&gt; headlights on/off (white)
HL,RR,GG,BB           -&gt; headlights RGB
BZ,HH,LL,DD           -&gt; buzzer freq=(HH&lt;&lt;8)|LL Hz, dur=DD*10 ms
EC,00                 -&gt; echo/no-op

Replies (newline-terminated), with command echo:
#ECHO,&lt;raw line without '!'&gt;\n
:SEQ,ACK,OP\n          (e.g., :0A,ACK,MV)
:00,ACK,??\n           (if the command couldn't be parsed)
#LED,rrggbb\n          (after HL)
#BUZ,done\n            (after BZ)

Notes:
- No queue; each command is handled immediately when '!' arrives.
- Keep writes from the app to a single packet per command ending with '!'.
</comment><block type="pxt-on-start" id="rXjOXFj|nCtCc)X?N,OJ" x="20" y="20"><statement name="HANDLER"><block type="typescript_statement" id="P)_ft$g3raCN+jEp4MD["><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let seqNum = 0" numlines="1" declaredvars="seqNum"></mutation><next><block type="typescript_statement" id="FV9VA}T}NzM=L`6HwT4i"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let v = 0" numlines="1" declaredvars="v"></mutation><next><block type="bluetooth_start_uart_service" id="I4FIv1xvCn34j`JD6#~G"><data>0</data><next><block type="typescript_statement" id="CA/IMvak9_9u4_(vm-y-"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="interface Cmd { s: number; o: string; a: number; b: number; c: number }" numlines="1"></mutation><next><block type="typescript_statement" id="G_pWd?2R/5ZP.y6FxQQ2"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="function runNow(cmd: Cmd) {" line1="    switch (cmd.o) {" line2="        case &quot;MV&quot;:" line3="            // forward icon per your spec: show DOWN arrow" line4="            basic.showArrow(ArrowNames.South)" line5="            cuteBot.motors(cmd.a, cmd.b)" line6="            break" line7="" line8="        case &quot;SP&quot;:" line9="            hardStop()" line10="            break" line11="" line12="        case &quot;TL&quot;:" line13="            // show RIGHT arrow (your spec)" line14="            basic.showArrow(ArrowNames.East)" line15="            cuteBot.turnleft()" line16="            break" line17="" line18="        case &quot;TR&quot;:" line19="            // show LEFT arrow (your spec)" line20="            basic.showArrow(ArrowNames.West)" line21="            cuteBot.turnright()" line22="            break" line23="" line24="        case &quot;BK&quot;: {" line25="            basic.showArrow(ArrowNames.North)" line26="            const spd = cmd.a &gt; 0 ? cmd.a : 50" line27="            cuteBot.motors(-spd, -spd)" line28="            break" line29="        }" line30="" line31="        case &quot;HL&quot;: {" line32="            let color: number" line33="            if (cmd.b &gt; 0 || cmd.c &gt; 0) {" line34="                color = ((cmd.a &amp; 0xFF) &lt;&lt; 16) | ((cmd.b &amp; 0xFF) &lt;&lt; 8) | (cmd.c &amp; 0xFF)" line35="                cuteBot.colorLight(cuteBot.RGBLights.ALL, color)" line36="            } else {" line37="                color = cmd.a ? 0xFFFFFF : 0x000000" line38="                cuteBot.colorLight(cuteBot.RGBLights.ALL, color)" line39="            }" line40="            const rr = hex2((color &gt;&gt; 16) &amp; 0xFF)" line41="            const gg = hex2((color &gt;&gt; 8) &amp; 0xFF)" line42="            const bb = hex2(color &amp; 0xFF)" line43="            send(&quot;#LED,&quot; + rr + gg + bb + &quot;\n&quot;)" line44="            break" line45="        }" line46="" line47="        case &quot;BZ&quot;: {" line48="            const freq = ((cmd.a &amp; 0xFF) &lt;&lt; 8) | (cmd.b &amp; 0xFF)" line49="            let dur = (cmd.c &amp; 0xFF) * 10" line50="            if (dur &lt;= 0) dur = 100" line51="            const h = Math.max(100, Math.min(5000, freq))" line52="            music.playTone(h, dur)  // synchronous" line53="            send(&quot;#BUZ,done\n&quot;)" line54="            break" line55="        }" line56="" line57="        case &quot;EC&quot;:" line58="            // no action; just ACK" line59="            break" line60="" line61="        default:" line62="            sendErr(cmd.s, 0x01)" line63="            return" line64="    }" line65="}" numlines="66"></mutation></block></next></block></next></block></next></block></next></block></statement></block><block type="argument_reporter_string" id="{d=}fBQcc;5(cusNTr5O" disabled-reasons="pxt_automatic_disabled" x="932" y="20"><field name="VALUE">raw</field></block><block type="argument_reporter_string" id="h6S$dow1swA~m?MIO7SS" disabled-reasons="pxt_automatic_disabled" x="1030" y="20"><field name="VALUE">line</field></block><block type="bluetooth_on_data_received" id="1E=?mGIyLKMQQ5Txw:;?" x="1138" y="20"><comment pinned="false" h="80" w="160">Hook the '!' terminator</comment><value name="delimiters"><shadow type="serial_delimiter_conv" id="/w0N-/QSMV+m85E*/RJH"><field name="del">Delimiters.NewLine</field></shadow><block type="text" id="?qBzn_]M4u2xdBsfY7z!"><field name="TEXT">!</field></block></value><statement name="HANDLER"><block type="function_call" id="kawKQW7VoFCLf*xc*{D0"><mutation name="onBang" functionid="x)yNcf/PLG^5%??J(/wB"></mutation></block></statement></block><block type="function_definition" id="{FpMr5w3dfu@IG2m,*j[" x="1532" y="20"><mutation name="hex2" functionid="T0Pqq?ER@6`Jb8+r~+|:"><arg name="n" id="ud9jlz165xvykgqk61yrp" type="number"></arg></mutation><field name="function_name">hex2</field><comment pinned="false" h="80" w="160">---------- helpers ----------</comment><value name="ud9jlz165xvykgqk61yrp"><block type="argument_reporter_number" id="(h|.Zu*b@y+^D@2{1KNI" deletable="false"><field name="VALUE">n</field></block></value><statement name="STACK"><block type="typescript_statement" id="@_QKn-:y4mF;@d+4,(Ck"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="n &amp;= 0xFF" numlines="1"></mutation><next><block type="variables_set" id="qDU@2b6m{XBimK[4wNP1"><field name="VAR" id="U2|dP3WM^{Av(2(!truy">d</field><value name="VALUE"><shadow type="math_number" id="Wf1NO0DmKDnhJ]oys|QM"><field name="NUM">0</field></shadow><block type="text" id=")ohsUkjlXuvhR6rul:.w"><field name="TEXT">0123456789ABCDEF</field></block></value><next><block type="function_return" id="i_[De[=zQ2TK=cMAoTFR"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="/)404hIkLvIe%{`~azGm"><field name="NUM">0</field></shadow><block type="text_join" id="+{j@?ZxcU*?4Fb0)`q3^"><mutation items="2"></mutation><value name="ADD0"><shadow type="text" id="nI]kXBq;8pCk~owV1{5M"><field name="TEXT"></field></shadow><block type="string_get" id="vY`MpNbR9,11@IfjrYPr"><value name="this"><shadow type="text" id="+Y^2YLDpoiK0T3h^Et%0"><field name="TEXT"></field></shadow><block type="variables_get" id="q^YDC*KPZ*Ubc}9CkKSm"><field name="VAR" id="U2|dP3WM^{Av(2(!truy">d</field></block></value><value name="pos"><block type="typescript_expression" id="H|E7s.PW=z6STb{u/#}^"><field name="EXPRESSION">(n &gt;&gt; 4) &amp; 0xF</field></block></value></block></value><value name="ADD1"><shadow type="text" id=";k3^/v=egyfFTCu70Bb{"><field name="TEXT"></field></shadow><block type="string_get" id="{b5d}u{+WMgQ=d`(%6b="><value name="this"><shadow type="text" id="jR4#%tpGeN}C6Y%2tP3o"><field name="TEXT"></field></shadow><block type="variables_get" id="(Occg._}J`DsNC.7Kd[i"><field name="VAR" id="U2|dP3WM^{Av(2(!truy">d</field></block></value><value name="pos"><block type="typescript_expression" id="Zpt*q54zMEr24v;y/LV)"><field name="EXPRESSION">n &amp; 0xF</field></block></value></block></value></block></value></block></next></block></next></block></statement></block><block type="function_definition" id="[|^QhW|2mdHSVq,kK;WU" x="2493" y="20"><mutation name="parseHexByte" functionid="Qo;Z^(.4~lGu!HinX{T~"><arg name="s" id="k0a56re8upuw1bn8pkcg" type="string"></arg></mutation><field name="function_name">parseHexByte</field><value name="k0a56re8upuw1bn8pkcg"><block type="argument_reporter_string" id="rUv|U@`n?b-sm9x7eTLG" deletable="false"><field name="VALUE">s</field></block></value><statement name="STACK"><block type="typescript_statement" id="J[OzB%zs:ek,9;99o(*("><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const t = s ? s.trim().toUpperCase() : &quot;&quot;" numlines="1" declaredvars="t"></mutation><next><block type="controls_if" id="Cc7@Z?|t/}Z,^4xZA%mf"><value name="IF0"><shadow type="logic_boolean" id="=IjzqDb5-_N/(}QtLr$J"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="B7Wuzue=iu|EPbbPb3Gz"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="l}/Q1HHPvp@J7EoXt7p,"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="uJ^=HZ(}!kE2u0N)8Bl,"><value name="BOOL"><shadow type="logic_boolean" id="M{;dNs4a~GjC7a3QFU?+"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="#7sawehhS.7K:QeshDde"><field name="VAR" id="1^cABJ;?ZY9D~*9KifSt">t</field></block></value></block></value><value name="B"><shadow type="logic_boolean" id="_4[b*!b^QhgAw27.bUD/"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id=")mgM~3v=?6]62W$`__$:"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="!,G9,v9hKSN[RyC/-2Ky"><field name="NUM">0</field></shadow><block type="text_length" id="/,riO/$%iU,wNA]Zv9$Y"><value name="VALUE"><block type="variables_get" id="6M|chPS_6*ZKoayI8XNM"><field name="VAR" id="1^cABJ;?ZY9D~*9KifSt">t</field></block></value></block></value><value name="B"><shadow type="math_number" id="fjsAp}eM+yG($|b@=!3i"><field name="NUM">0</field></shadow></value></block></value></block></value><statement name="DO0"><block type="function_return" id="A7nXoSd^gknL7}Mplm]g"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="oLvP5$K!S/TJsbw{XCBM"><field name="NUM">0</field></shadow></value></block></statement><next><block type="typescript_statement" id="uix6jx2?P3m_!Y^9ymfa"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="for (let i = 0; i &lt; t.length &amp;&amp; i &lt; 2; i++) {" line1="        const c = t.charCodeAt(i)" line2="        let e = -1" line3="        if (c &gt;= 48 &amp;&amp; c &lt;= 57) e = c - 48" line4="        else if (c &gt;= 65 &amp;&amp; c &lt;= 70) e = c - 55" line5="        if (e &lt; 0) break" line6="        v = (v &lt;&lt; 4) | e" line7="    }" numlines="8"></mutation><next><block type="function_return" id="i~^?j@`)cuIDKrK;jg~8"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="v36JQzCawhM=6Y5b@e|s"><field name="NUM">0</field></shadow><block type="typescript_expression" id="]cHRd!%*equXeN7=6|xt"><field name="EXPRESSION">v &amp; 0xFF</field></block></value></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="~.:O050V{9xNXU,qyYg@" x="3199" y="20"><mutation name="send" functionid="z.hO/@-0@nQnRkf2z)z:"><arg name="line" id="3kws9su03ijbiyzb9vfi" type="string"></arg></mutation><field name="function_name">send</field><value name="3kws9su03ijbiyzb9vfi"><block type="argument_reporter_string" id="%VnDGawoI;dvVS[r-2wZ" deletable="false"><field name="VALUE">line</field></block></value><statement name="STACK"><block type="bluetooth_uart_write" id="VV*Dr66z/%M#gq$[)?b9"><value name="data"><block type="argument_reporter_string" id="*==)7ltuqf;gv9,`=W;a"><field name="VALUE">line</field></block></value></block></statement></block><block type="function_definition" id="|Pf1s*1arG-GyGiN=xX`" x="3604" y="20"><mutation name="sendAckWithOp" functionid="j)1IA5?|P,,WgXo;S}iT"><arg name="seq" id="8n45kask0p60lxbducz9j" type="number"></arg><arg name="opEcho" id="2isbmywfozkwdmm2jgqk3" type="string"></arg></mutation><field name="function_name">sendAckWithOp</field><value name="8n45kask0p60lxbducz9j"><block type="argument_reporter_number" id="2d*o2p$#]*bO!oE1HkN8" deletable="false"><field name="VALUE">seq</field></block></value><value name="2isbmywfozkwdmm2jgqk3"><block type="argument_reporter_string" id="c3dP)tW0QM(r|uV|*2Nf" deletable="false"><field name="VALUE">opEcho</field></block></value><statement name="STACK"><block type="function_call" id="LCdb;t{Sk3p.Bv}g8uLo"><mutation name="send" functionid="z.hO/@-0@nQnRkf2z)z:"><arg name="line" id="3kws9su03ijbiyzb9vfi" type="string"></arg></mutation><value name="3kws9su03ijbiyzb9vfi"><shadow type="text" id="EQv:-aIUzwLm|{:05t.h"><field name="TEXT">abc</field></shadow><block type="text_join" id="U~$Db`wF_U+P%~^B}^=r" inline="false"><mutation items="5"></mutation><value name="ADD0"><shadow type="text" id="2C-:@7Oso.[Z:}]c@UW%"><field name="TEXT">:</field></shadow></value><value name="ADD1"><shadow type="text" id="=X.@.T$0ifZ.%:UUR6W^"><field name="TEXT"></field></shadow><block type="function_call_output" id="s.Q7P}6|?n|5?)j(l=Bn"><mutation name="hex2" functionid="T0Pqq?ER@6`Jb8+r~+|:"><arg name="n" id="ud9jlz165xvykgqk61yrp" type="number"></arg></mutation><value name="ud9jlz165xvykgqk61yrp"><shadow type="math_number" id="~VKe#o{*g)sN$De^;Azx"><field name="NUM">1</field></shadow><block type="argument_reporter_number" id="`WPa)])/=q~Y$6f`vg$E"><field name="VALUE">seq</field></block></value></block></value><value name="ADD2"><shadow type="text" id="~18)Zv6S?E4oSVz|^!4;"><field name="TEXT">,ACK,</field></shadow></value><value name="ADD3"><shadow type="text" id="|sJ=0)dIMe#p}NR0d^@5"><field name="TEXT"></field></shadow><block type="argument_reporter_string" id="_iVuPlJ3dKfCpb/5nN!N"><field name="VALUE">opEcho</field></block></value><value name="ADD4"><shadow type="text" id="dx-*bgrV8#fz3H%0+zG."><field name="TEXT"></field></shadow><block type="typescript_expression" id="Iff:~mE{bf~|Pst1s3fp"><field name="EXPRESSION">"\n"</field></block></value></block></value></block></statement></block><block type="function_definition" id="~+9LWX90UfeOGQ-_4x?#" x="4073" y="20"><mutation name="sendErr" functionid="|z:tC-FjzS5DeIk.Kg`p"><arg name="seq" id="e7tg5jq7kgrbzbb782d16g" type="number"></arg><arg name="ec" id="uj33m0ibo7igip4gjwbh" type="number"></arg></mutation><field name="function_name">sendErr</field><value name="e7tg5jq7kgrbzbb782d16g"><block type="argument_reporter_number" id="nwhQ[vbsKSDBVA|vkV1P" deletable="false"><field name="VALUE">seq</field></block></value><value name="uj33m0ibo7igip4gjwbh"><block type="argument_reporter_number" id="d8)7+Uzkw|W5}4[t=vh[" deletable="false"><field name="VALUE">ec</field></block></value><statement name="STACK"><block type="function_call" id=",oJ=l36;]e+;6?YuznJg"><mutation name="send" functionid="z.hO/@-0@nQnRkf2z)z:"><arg name="line" id="3kws9su03ijbiyzb9vfi" type="string"></arg></mutation><value name="3kws9su03ijbiyzb9vfi"><shadow type="text" id="R.SkV#[v6}Wh91~2u-/H"><field name="TEXT">abc</field></shadow><block type="text_join" id="2NBb;?L+a5DNp=Ik}XKN" inline="false"><mutation items="5"></mutation><value name="ADD0"><shadow type="text" id="QP7n:Un|ONKD_oYVY]6M"><field name="TEXT">:</field></shadow></value><value name="ADD1"><shadow type="text" id="3M~/y}A/M-?pXS(isohS"><field name="TEXT"></field></shadow><block type="function_call_output" id="jCpDNC,N6+J2(mR-FKA_"><mutation name="hex2" functionid="T0Pqq?ER@6`Jb8+r~+|:"><arg name="n" id="ud9jlz165xvykgqk61yrp" type="number"></arg></mutation><value name="ud9jlz165xvykgqk61yrp"><shadow type="math_number" id="{Z+,7lqfeV(iaze%3Ym*"><field name="NUM">1</field></shadow><block type="argument_reporter_number" id="F`Wc?5Fc|1ZEu2%H:#7S"><field name="VALUE">seq</field></block></value></block></value><value name="ADD2"><shadow type="text" id="51jjbNdbq[-6_p0Er}0X"><field name="TEXT">,ERR,</field></shadow></value><value name="ADD3"><shadow type="text" id="2`2WFK1GHL9evcx^$jH7"><field name="TEXT"></field></shadow><block type="function_call_output" id=".%glRC7x?R2r$pyJpHI~"><mutation name="hex2" functionid="T0Pqq?ER@6`Jb8+r~+|:"><arg name="n" id="ud9jlz165xvykgqk61yrp" type="number"></arg></mutation><value name="ud9jlz165xvykgqk61yrp"><shadow type="math_number" id="$d/GD*l=kXV{j-IS{:mG"><field name="NUM">1</field></shadow><block type="argument_reporter_number" id="i1O;22rDHq{]$Jb(.PV?"><field name="VALUE">ec</field></block></value></block></value><value name="ADD4"><shadow type="text" id="P4eNX7M/_NUjvfjqg%26"><field name="TEXT"></field></shadow><block type="typescript_expression" id="3uMZ+P]IWu@+@^cC{1DE"><field name="EXPRESSION">"\n"</field></block></value></block></value></block></statement></block><block type="function_definition" id="6RWL`eKXw3Zvm}Q^$`T!" x="4462" y="20"><mutation name="hardStop" functionid="OE-^|/QPlMuIBB_};WQY"></mutation><field name="function_name">hardStop</field><statement name="STACK"><block type="MotorRun" id="IQ@sK]~P)@QmJfhJ~3`J"><value name="lspeed"><shadow type="math_number_minmax" id="BO37%(,~eFJ}g:y0x4dz"><mutation min="-100" max="100" precision="0"></mutation><field name="SLIDER">0</field></shadow></value><value name="rspeed"><shadow type="math_number_minmax" id="r$jlofxs?=zql7b4nO*a"><mutation min="-100" max="100" precision="0"></mutation><field name="SLIDER">0</field></shadow></value><next><block type="typescript_statement" id="9tJzs]$cd|m_|9zxr{*I"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="try { cuteBot.stopcar() } catch (f) { }" numlines="1"></mutation><next><block type="basic_show_icon" id="a?4xLz-t8xeYk=_l.EcA"><field name="i">IconNames.No</field></block></next></block></next></block></statement></block><block type="function_definition" id="^e)y=E(rFZ(!sP(8T=gO" x="20" y="2985"><mutation name="guessOp" functionid="llRqwEVC19G$F`Z[Ks3B"><arg name="raw" id="qzeugosfwujrwtzlxdxn6" type="string"></arg></mutation><field name="function_name">guessOp</field><comment pinned="false" h="80" w="160">---------- tolerant OP guess (for ACK when parse fails) ----------</comment><value name="qzeugosfwujrwtzlxdxn6"><block type="argument_reporter_string" id="7RW#)B)R8Jv{YR#yuj]h" deletable="false"><field name="VALUE">raw</field></block></value><statement name="STACK"><block type="controls_if" id="H#Z8q7L3LD5$AJF;Q;Kf"><value name="IF0"><shadow type="logic_boolean" id="Y~)~Z)G(e{o=`k+^GD[d"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="InRW1~FX7m5LM1%iz5i."><value name="BOOL"><shadow type="logic_boolean" id="u^I!X2_{3VFTtMkjeo$F"><field name="BOOL">TRUE</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="lcb+3b8Mk-i;FFB*F7*v"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id=":#s{S3GueWO,V0T6q(#_"><field name="NUM">0</field></shadow><block type="text" id="DSKk!w[+aEuh-[}zQU]V"><field name="TEXT">??</field></block></value></block></statement><next><block type="typescript_statement" id="UI).8nmnb{+iG$MRMJx;"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let s = raw.trim()" numlines="1" declaredvars="s"></mutation><next><block type="controls_if" id="SEDTDTZvpRz6^~tahGm9"><value name="IF0"><shadow type="logic_boolean" id="OKHLTHal8[a^l9|a27Il"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="X93Wz~mj9b[C2%Z5e-FA"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="jI:o[0YX6(,=_t$$d%n/"><field name="NUM">0</field></shadow><block type="text_length" id="P6i+]HK8(i{yd/D#0F_o"><value name="VALUE"><block type="variables_get" id="n~c/7#MEhH]crYzfVO:%"><field name="VAR" id="YyDLo+sh[Rz^a;{fQ+R%">s</field></block></value></block></value><value name="B"><shadow type="math_number" id="H=K}(]k84YN]-Tc42h__"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="Y#5Pj(bNv?a[,TYBO;$,"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="CT[d4YoVnw-e*+lsh_^T"><field name="NUM">0</field></shadow><block type="text" id="]bEYt}wME[EDyTcaE;Ds"><field name="TEXT">??</field></block></value></block></statement><next><block type="controls_if" id="PD85;H4[~IvE?)Sl~:`2"><value name="IF0"><shadow type="logic_boolean" id="ySJpF67wF@KhhIc#+*dV"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="Ha,iT?rT^YZZDGHs~V!}"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="j%f%b$fcoMEawey~ECgY"><field name="NUM">0</field></shadow><block type="string_get" id="+9/iwOfdiKz@mZ^AE`F)"><value name="this"><shadow type="text" id=":h]]fogz|%pyeQ5R=5XC"><field name="TEXT"></field></shadow><block type="variables_get" id="h#=NIT7M/HAl+Mw5bzmn"><field name="VAR" id="YyDLo+sh[Rz^a;{fQ+R%">s</field></block></value><value name="pos"><shadow type="math_number" id="r!RHbaL?C^5}Esmg9.,V"><field name="NUM">0</field></shadow></value></block></value><value name="B"><shadow type="math_number" id="x!O}29G3gpJRFAuj|^ym"><field name="NUM">0</field></shadow><block type="text" id="pKm=!?7G}^}5@/pa;txJ"><field name="TEXT">:</field></block></value></block></value><statement name="DO0"><block type="variables_set" id="6MXY/RYJQ]Og@q07noXL"><field name="VAR" id="YyDLo+sh[Rz^a;{fQ+R%">s</field><value name="VALUE"><shadow type="math_number" id="VoTLnf2xIlDy+|6:/d!b"><field name="NUM">0</field></shadow><block type="string_substr_new" id=".Djnhg~%V?]erC09Btop"><mutation xmlns="http://www.w3.org/1999/xhtml" _expanded="0" _input_init="true"></mutation><value name="this"><shadow type="text" id="=Qb=UuG.bvmcwVA5apE5"><field name="TEXT"></field></shadow><block type="variables_get" id="B=;S+4vi{;~2?r)l^^(~"><field name="VAR" id="YyDLo+sh[Rz^a;{fQ+R%">s</field></block></value><value name="start"><shadow type="math_number" id="]d+EqR3xM1oV2#E(vMNp"><field name="NUM">1</field></shadow></value></block></value></block></statement><next><block type="variables_set" id="_ui^~%;Bn4KrAIm+GFMy"><field name="VAR" id="U$d?zis}dPlDI|?^Uw6d">parts</field><value name="VALUE"><shadow type="math_number" id="9$6te{]rP}3%9gs)-%GM"><field name="NUM">0</field></shadow><block type="string_split" id="qa]casH(Nap`WOj0!HO~"><value name="this"><shadow type="text" id="D[7-4qy8670v44G*.1$."><field name="TEXT"></field></shadow><block type="variables_get" id="9Z=v]zFKf^%zan=T7)uX"><field name="VAR" id="YyDLo+sh[Rz^a;{fQ+R%">s</field></block></value><value name="separator"><shadow type="text" id="{SO=JaLvagApUQ#2[8hs"><field name="TEXT">,</field></shadow></value></block></value><next><block type="controls_if" id=";nq^3*sHnY:uGxE{(aaI"><value name="IF0"><shadow type="logic_boolean" id="$wTht0HNxQUY|C*TGXKI"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="a8$sl:*GPT}!sE3E$%v6"><field name="OP">LT</field><value name="A"><shadow type="math_number" id="k;.};HCq)9+K@L9.2$f1"><field name="NUM">0</field></shadow><block type="lists_length" id="T2pxCeh?U15TOTvyPxGh"><value name="VALUE"><block type="variables_get" id="CX;=cLnOTv0pX]f@m_mj"><field name="VAR" id="U$d?zis}dPlDI|?^Uw6d">parts</field></block></value></block></value><value name="B"><shadow type="math_number" id="wL.:z]P7!3ejAve_McxV"><field name="NUM">2</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="m?v.9E1_1|0_QPNK0t:@"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="{N1h!UHi36.LL~97`#9@"><field name="NUM">0</field></shadow><block type="text" id="rTnvgyk0(3`l@RjB3|~D"><field name="TEXT">??</field></block></value></block></statement><next><block type="typescript_statement" id="LsS8SssOl9r%sH;uu0T:"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const op = parts[1].trim().toUpperCase()" numlines="1" declaredvars="op"></mutation><next><block type="controls_if" id="{FP]gKdwof*m6PN]0r+t"><value name="IF0"><shadow type="logic_boolean" id="Z4H*6uG=cY~4Fy#9j4DR"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="!,8=]r:G^%sRc-#l1Pup"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="j}#_D8EaV~5Y|T688~;x"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="%;v_eGE~=!2AzWSy;.tn"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="XaPx*0]WTlEFg}8%AvvP"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="$:Y4fKEgaqh;$bW1`NJ8"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="w=i;7lyHKtZ{_Z)4!?0a"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="3#00C_L_,M9SN{N1h4]u"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="@uA6PlwUcoP@E?K?|#;4"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="8geJiqi6SYwNj7K|!?aX"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="X6PjZbhy/7Ad^lcrP3t{"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="gKF#[`FLI2-umS=+x2fS"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="qaYeY[Pr-(}E!o.q4KR["><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="HRQJ.^mD3w0F[IxP~BLT"><field name="OP">OR</field><value name="A"><shadow type="logic_boolean" id="NNA)?3@?9X$i-K%_{,)^"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="#U-Li*4R6J)(W]6+y}yf"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="K@3z:wi`4KN%R*;06MOF"><field name="NUM">0</field></shadow><block type="variables_get" id="|!|!MRJxp.Tn;1D+PX$Y"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="xyxw^E5{#XGng`@2ty9@"><field name="NUM">0</field></shadow><block type="text" id="$A@bN!jD8pj!wLxkw6n;"><field name="TEXT">MV</field></block></value></block></value><value name="B"><shadow type="logic_boolean" id="+d4slWl3]mWwL%;BU/Kt"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="hyPUlCw$S8Hni(SYamQ1"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="r[FhiphOfJ^LaX~xphQ#"><field name="NUM">0</field></shadow><block type="variables_get" id="v0#6N@_x19%wEzShg4;9"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="p0kXWwRKc#E(xJ?.lN;S"><field name="NUM">0</field></shadow><block type="text" id="T|i)hXHB,_6Y_`@)0u75"><field name="TEXT">SP</field></block></value></block></value></block></value><value name="B"><shadow type="logic_boolean" id="NgWi-L[Gz@hv%Jx+k*FQ"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="gbP,3Dt}~g3%{2^0Kw5G"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="[aS%h^Y!Xz?hdLDw5D+m"><field name="NUM">0</field></shadow><block type="variables_get" id="lLmouh!.eo.v6(mmW-@q"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="Dd5c-bej$bPh~F:5@c;H"><field name="NUM">0</field></shadow><block type="text" id="wQU2i/!R03a754_0ibzx"><field name="TEXT">TL</field></block></value></block></value></block></value><value name="B"><shadow type="logic_boolean" id="|7zPr4eh*dMnOT.k+sP~"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="RTfEJXNxCpv@o*,Sy#7z"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="TS#D(Q1Hota575a=S}6s"><field name="NUM">0</field></shadow><block type="variables_get" id="-Mlf*eY8C}j;J*GKT2HK"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="tPk~qmW^_MuS7%HRd2V1"><field name="NUM">0</field></shadow><block type="text" id="}+m=A}lY.oaVc?{-n98p"><field name="TEXT">TR</field></block></value></block></value></block></value><value name="B"><shadow type="logic_boolean" id="]xhj=wOw!n!V28Z1`{tE"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="SOgh)U`IaH$g`#+v:iTc"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="HtUtvjm2pS.+P6a;/mkR"><field name="NUM">0</field></shadow><block type="variables_get" id="GFq%+{L}`9RD3%tTZ-uu"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="GP-tEdvpYVoZhSfW*A,!"><field name="NUM">0</field></shadow><block type="text" id="!/tY;r9iIpu6+.,E~4oT"><field name="TEXT">BK</field></block></value></block></value></block></value><value name="B"><shadow type="logic_boolean" id="3!_#kYAt-%`FbL`oi}y1"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="nuaVZahw1ZPj=Y#;L+DH"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="`9HT5#`{3cn/[Eii9^%F"><field name="NUM">0</field></shadow><block type="variables_get" id="F~87}12~x):r/~,K/Ok~"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="|rtZ*eYI#lvvst}U[e!="><field name="NUM">0</field></shadow><block type="text" id="Ea}201;-U~;ug6=s.HTN"><field name="TEXT">HL</field></block></value></block></value></block></value><value name="B"><shadow type="logic_boolean" id="6-nQD5u-k!mY~SP61mWY"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="gY/SjRf]Cs,|*fN[zwNS"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="HTt7``[?P(=:V0h.CTch"><field name="NUM">0</field></shadow><block type="variables_get" id="xMao;_($z](Zd[)k7ZR["><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="l4wV3qt)ia,v%H$ZJQT*"><field name="NUM">0</field></shadow><block type="text" id="VF-/s/oE|gFbz.-3h4#%"><field name="TEXT">BZ</field></block></value></block></value></block></value><value name="B"><shadow type="logic_boolean" id="0HVNg^+8W7at|iFzKr58"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="[r!=aRdNmc8p288hT`8#"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="%V~.Bv_TfdSeGpm`[-w("><field name="NUM">0</field></shadow><block type="variables_get" id="7,TT$w=?+OwT=c}G~d,h"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value><value name="B"><shadow type="math_number" id="qP.w]w30pRzk?*Qw|1OT"><field name="NUM">0</field></shadow><block type="text" id="ptzRvru.R+72R;dG+;GH"><field name="TEXT">EC</field></block></value></block></value></block></value><statement name="DO0"><block type="function_return" id="O-sG!BM5WA?O_(nnMKu7"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="e,jF~@D7vWd+o%kBqIaI"><field name="NUM">0</field></shadow><block type="variables_get" id="E9FdSEMbDZ$?2EG~cNWU"><field name="VAR" id="/iD:t/KtoLmpvkZq,?0[">op</field></block></value></block></statement><next><block type="function_return" id="l/y6fZM:t=-nRzuL9JG;"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="vCCcj{DtjUIZnf`F6T[t"><field name="NUM">0</field></shadow><block type="text" id="h(Xvj9OhHS)1JfIvSExm"><field name="TEXT">??</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="!53QLP6A0LC:BF?EwLRK" x="2634" y="2985"><mutation name="parseLine" functionid="cFh,B_uIPibZpiqFP56A"><arg name="line" id="2acdl58fzxudhfg9y5mo" type="string"></arg></mutation><field name="function_name">parseLine</field><comment pinned="false" h="80" w="160">---------- parser (forgiving; returns null if unusable) ----------</comment><value name="2acdl58fzxudhfg9y5mo"><block type="argument_reporter_string" id="F/9Vr[}6bEjslxdbp;g5" deletable="false"><field name="VALUE">line</field></block></value><statement name="STACK"><block type="controls_if" id=":}(?l@3M`o.+~2J(:mP@"><value name="IF0"><shadow type="logic_boolean" id="@[)UcOx/yWvwLqjhtG?~"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="b4.#%x:]aKF$UAKVi.AN"><value name="BOOL"><shadow type="logic_boolean" id="z1GIffZYQ%uH+U3LZyGA"><field name="BOOL">TRUE</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="ig]yN:kOfMxyc)Q+Wk:Z"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="_//t]+dCzb%;Zmu(El_u"><field name="NUM">0</field></shadow><block type="typescript_expression" id="UHddC%wWQ)q07!fqYfnk"><field name="EXPRESSION">null</field></block></value></block></statement><next><block type="typescript_statement" id="ejP}@ks1(ThuBkd3L-xV"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let u = line.trim()" numlines="1" declaredvars="u"></mutation><next><block type="controls_if" id="sF9.Wp|rVCU~8kPqHBF-"><value name="IF0"><shadow type="logic_boolean" id="CZJO{HxVbc$0DZvYdVeC"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="YZyn.l9IJ]P}yPV5A|H."><field name="OP">LT</field><value name="A"><shadow type="math_number" id="6FH/S(@Wk!RbzY!z`++F"><field name="NUM">0</field></shadow><block type="text_length" id="a0VZLwjZ=Ai,eS6r)pOp"><value name="VALUE"><block type="variables_get" id="mJsgU7%(gW8C5m^7iC)Z"><field name="VAR" id="zC|f_%hDhg7a*Yp+w67t">u</field></block></value></block></value><value name="B"><shadow type="math_number" id="M4n]zEE8Gk7IuSw/S*W7"><field name="NUM">2</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="E1RZq0g}W)RK|?eC8-{["><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="[CRJZ;nTs00qh6k_^$g="><field name="NUM">0</field></shadow><block type="typescript_expression" id="4d*?78{GH*0`kY9*[~N;"><field name="EXPRESSION">null</field></block></value></block></statement><next><block type="controls_if" id="zRxU.-HJ0I[N%-W;ukg("><value name="IF0"><shadow type="logic_boolean" id="H:O6ozPF3)npjOIY5X1s"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="Dr(1^myp]VBCQFI#4{2h"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="c^VFvk)FhFBr30miP;lM"><field name="NUM">0</field></shadow><block type="string_get" id="n)4#cz98RmXcs;^b|eBn"><value name="this"><shadow type="text" id="$xFEPlOnVjO2~#L#vpHf"><field name="TEXT"></field></shadow><block type="variables_get" id="X-gBIG1BhdoOj5V,[2h!"><field name="VAR" id="zC|f_%hDhg7a*Yp+w67t">u</field></block></value><value name="pos"><shadow type="math_number" id="f[1lbk=lYY9{TbFKvR2y"><field name="NUM">0</field></shadow></value></block></value><value name="B"><shadow type="math_number" id="_A8lMUST`^|4+o}0).c*"><field name="NUM">0</field></shadow><block type="text" id="Wl0AF@hm?SS}xa(H$w-U"><field name="TEXT">:</field></block></value></block></value><statement name="DO0"><block type="variables_set" id="Gyj!C_d|{-]#s^@PDNVX"><field name="VAR" id="zC|f_%hDhg7a*Yp+w67t">u</field><value name="VALUE"><shadow type="math_number" id="uuMKNpB0GkLY|Ryg[UP5"><field name="NUM">0</field></shadow><block type="string_substr_new" id="F.D4Y5Cw~;M;l@jS+$~="><mutation xmlns="http://www.w3.org/1999/xhtml" _expanded="0" _input_init="true"></mutation><value name="this"><shadow type="text" id=";!$6Fea^kT{-S)S$~4E`"><field name="TEXT"></field></shadow><block type="variables_get" id=",%MEn]LD-0LN,OD^`]2["><field name="VAR" id="zC|f_%hDhg7a*Yp+w67t">u</field></block></value><value name="start"><shadow type="math_number" id="G1U}swV84zEv$0/oUqIR"><field name="NUM">1</field></shadow></value></block></value></block></statement><next><block type="variables_set" id="BE::)M5ag][x9#b2/)?8"><field name="VAR" id="@FRdwCL/#3IkqkK{)R_;">parts2</field><value name="VALUE"><shadow type="math_number" id="6J%O_wr2?@a~G%{EA{x_"><field name="NUM">0</field></shadow><block type="string_split" id="!X!vPCTypVwVx(aWI`nd"><value name="this"><shadow type="text" id="hqhbI6Ols7|rCmgij%*5"><field name="TEXT"></field></shadow><block type="variables_get" id="8|Og]36titGwccB:hd]o"><field name="VAR" id="zC|f_%hDhg7a*Yp+w67t">u</field></block></value><value name="separator"><shadow type="text" id="/{RnIzvw2#wBdJY.%k#h"><field name="TEXT">,</field></shadow></value></block></value><next><block type="controls_if" id="VR#JQh.Abl6lg]*[lsF-"><value name="IF0"><shadow type="logic_boolean" id="Z:(eGm41,ufzM6dtwXTR"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="n%Z*0:v*(ZRo|jCc:{DE"><field name="OP">LT</field><value name="A"><shadow type="math_number" id=".8[a,x,faO@}oQW$z;SF"><field name="NUM">0</field></shadow><block type="lists_length" id="CIdKR0lGUgpfuJR1hZTP"><value name="VALUE"><block type="variables_get" id="{^JC0pTvjV}S+;GKildp"><field name="VAR" id="@FRdwCL/#3IkqkK{)R_;">parts2</field></block></value></block></value><value name="B"><shadow type="math_number" id="cUOJv+8w.gJP[t$zzJ+z"><field name="NUM">2</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="OB_JaHm]4q`rCIb^KcyH"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="JNx[O(p=iU3B}TnC[7iQ"><field name="NUM">0</field></shadow><block type="typescript_expression" id="}gX39k=}NTk-VTyWbK^Y"><field name="EXPRESSION">null</field></block></value></block></statement><next><block type="variables_set" id="9g~]D[akvm+?KI}QAK7s"><field name="VAR" id="ZEz^f.v~QRCR:{A#!(tK">seqHex</field><comment pinned="false" h="80" w="160">SEQ</comment><value name="VALUE"><shadow type="math_number" id="VuXa*l4YgU1Wv$d5a3}g"><field name="NUM">0</field></shadow><block type="lists_index_get" id="0whVCu+k4P4!gdE6};{%"><value name="LIST"><block type="variables_get" id="Gce)th_j.rK)|vtY!M_v"><field name="VAR" id="@FRdwCL/#3IkqkK{)R_;">parts2</field></block></value><value name="INDEX"><shadow type="math_number" id="Kl9,/oRk_3KPV0SgvwkT"><field name="NUM">0</field></shadow></value></block></value><next><block type="controls_if" id="V[tkr];cw3yI3v0UHUaC"><value name="IF0"><shadow type="logic_boolean" id=")p:R8InphW9Vcn33rLY:"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="#po@O.-TxA(4r$vpQK`3"><field name="OP">AND</field><value name="A"><shadow type="logic_boolean" id="b?(2Xj`Ck:yW90|o5!z)"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id=":.=c+X2~nm0lbceFklzk"><field name="VAR" id="ZEz^f.v~QRCR:{A#!(tK">seqHex</field></block></value><value name="B"><shadow type="logic_boolean" id="TYB|N9Y=9XL{q]aupD~J"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="+p_KQ)#A6C@.dG-rRQUU"><field name="OP">GT</field><value name="A"><shadow type="math_number" id="S(lD,t`uP(hpMX@s:Hit"><field name="NUM">0</field></shadow><block type="text_length" id="xQB;hMh+bQ!omUXkC]xE"><value name="VALUE"><block type="variables_get" id="/dK|1sb0;8Bkh^qmlJIc"><field name="VAR" id="ZEz^f.v~QRCR:{A#!(tK">seqHex</field></block></value></block></value><value name="B"><shadow type="math_number" id="5}M#oYp3G8tk:tg^TX`i"><field name="NUM">0</field></shadow></value></block></value></block></value><statement name="DO0"><block type="typescript_statement" id="QRxVIa2RG}Qg_(@v9962"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const tmp = parseInt(seqHex, 16)" numlines="1" declaredvars="tmp"></mutation><next><block type="controls_if" id="FZram9umz#Oxq6?F@x!w"><value name="IF0"><shadow type="logic_boolean" id="Du,:tYbXXtq3YwXmA;S|"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="S26i,P?.9SGYQE+puL~s"><value name="BOOL"><shadow type="logic_boolean" id=":^?Mf/4^YHx-un7s$-Zj"><field name="BOOL">TRUE</field></shadow><block type="typescript_expression" id=".opb}(mK5WRH|[4-muDh"><field name="EXPRESSION">isNaN(tmp)</field></block></value></block></value><statement name="DO0"><block type="typescript_statement" id="ut3PyN;u*GQU0l4NcZ:Q"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="seqNum = tmp &amp; 0xFF" numlines="1"></mutation></block></statement></block></next></block></statement><next><block type="typescript_statement" id="x#{F,gzo!Cf*)(Va)*@+"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const op2 = (parts2[1] || &quot;&quot;).trim().toUpperCase()" numlines="1" declaredvars="op2"></mutation><next><block type="controls_if" id="(f,tbq3b@-;wmw4.Lnd]"><value name="IF0"><shadow type="logic_boolean" id="0d@hb~6E0ZthgrC(2E8?"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="NpXcw@fohWA/;O`~4(z+"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="JNJ,#4]]~~@48t2*s;|C"><field name="NUM">0</field></shadow><block type="text_length" id="|x|.!k^cTZ_MXIbrSuHY"><value name="VALUE"><block type="variables_get" id="C/^nVNA9t@X{NF%#T7;J"><field name="VAR" id="#)=`]V=rN0xlmymZDi5M">op2</field></block></value></block></value><value name="B"><shadow type="math_number" id="xx#b4R=s(tLM1kxEu11U"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="-1(779fS)em-w1.h9k#K"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="/bzj_CiU9rizx/$@hqB4"><field name="NUM">0</field></shadow><block type="typescript_expression" id="_Svz:aKd4sTQlT+F5@1M"><field name="EXPRESSION">null</field></block></value></block></statement><next><block type="typescript_statement" id="15_e1jC!R`qtF56xgx$$"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const a = parts2.length &gt; 2 ? parseHexByte(parts2[2]) : 0" numlines="1" declaredvars="a"></mutation><next><block type="typescript_statement" id="SF#(Ld85F0+J,Q3vaOC`"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const b = parts2.length &gt; 3 ? parseHexByte(parts2[3]) : 0" numlines="1" declaredvars="b"></mutation><next><block type="typescript_statement" id="hkYf1Jic)2$]0-Yi4+o6"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const g = parts2.length &gt; 4 ? parseHexByte(parts2[4]) : 0" numlines="1" declaredvars="g"></mutation><next><block type="function_return" id="e6n:Mbw1EchSK1p,EHOW"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="ET9HRSrnv~/0fHt7)|!{"><field name="NUM">0</field></shadow><block type="typescript_expression" id="!T|~x.iYPmEqpcmJrm}a"><field name="EXPRESSION">{ s: seqNum, o: op2, a: a, b: b, c: g }</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="U`CW*UGwmFUZ*u6EpV?W" x="3381" y="2985"><mutation name="onBang" functionid="x)yNcf/PLG^5%??J(/wB"></mutation><field name="function_name">onBang</field><comment pinned="false" h="80" w="160">---------- receiver for '!' delimiter (no queue) ----------</comment><statement name="STACK"><block type="variables_set" id="C-+Ps(F+PtDYa#:ea{(k"><field name="VAR" id="PReV_rbxy+a?${h?X6,Q">raw</field><comment pinned="false" h="80" w="160">Read up to '!' (the delimiter). Result does NOT include the '!'</comment><value name="VALUE"><shadow type="math_number" id="53|0}tDuVR^F[%Px?.jW"><field name="NUM">0</field></shadow><block type="bluetooth_uart_read" id="MGd_{vL,,26J8#ns`+PC"><value name="del"><shadow type="serial_delimiter_conv" id="2i2X^6S^ldM~X_$cS?cb"><field name="del">Delimiters.NewLine</field></shadow><block type="text" id="8pG%m.E#=I*R/PZe#,4%"><field name="TEXT">!</field></block></value></block></value><next><block type="function_call" id="B[epk[Zu_tKqa2HV5p~b"><mutation name="send" functionid="z.hO/@-0@nQnRkf2z)z:"><arg name="line" id="3kws9su03ijbiyzb9vfi" type="string"></arg></mutation><comment pinned="false" h="80" w="160">Echo exactly what we got (without the '!')</comment><value name="3kws9su03ijbiyzb9vfi"><shadow type="text" id="qFQ~JeUR@]F-mQhCqV:O"><field name="TEXT">abc</field></shadow><block type="text_join" id="u!AL:r8je~Te5-toK-2l"><mutation items="3"></mutation><value name="ADD0"><shadow type="text" id="{MY@(uOVogNhlr?I.:V`"><field name="TEXT">#ECHO,</field></shadow></value><value name="ADD1"><shadow type="text" id="U30|5%B]Sa;C!gcB5v}]"><field name="TEXT"></field></shadow><block type="variables_get" id="us.Qu|9pvQ_Q$wp.3K;5"><field name="VAR" id="PReV_rbxy+a?${h?X6,Q">raw</field></block></value><value name="ADD2"><shadow type="text" id="R7n;!mD_ru,(HR`8zV%r"><field name="TEXT"></field></shadow><block type="typescript_expression" id="9v3n#I=x};:o{(`9dz?v"><field name="EXPRESSION">"\n"</field></block></value></block></value><next><block type="typescript_statement" id="_WgT/TTQ~`{Zl)xt+5WK"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const line = raw.trim()" numlines="1" declaredvars="line"></mutation><next><block type="controls_if" id=":{xoTh}qC+ZTrHStG|_r"><value name="IF0"><shadow type="logic_boolean" id="9.*CAjv_rY@7Lb5JmuSE"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id=")j`G4zO__sKc6ib.6q0]"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="PnI;ag(fCeEhrUbfOMla"><field name="NUM">0</field></shadow><block type="text_length" id="IJGbhgkO?/d{%Ys=jNWP"><value name="VALUE"><block type="variables_get" id="RQdBJOq_U(xon{I,5fNE"><field name="VAR" id="bFk@v:a#+pO,$T`.7%tw">line</field></block></value></block></value><value name="B"><shadow type="math_number" id="~tEruy6oSE9nMk7fg6|B"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="function_call" id="KYv-ksf{6_uKT1dXy}o{"><mutation name="sendAckWithOp" functionid="j)1IA5?|P,,WgXo;S}iT"><arg name="seq" id="8n45kask0p60lxbducz9j" type="number"></arg><arg name="opEcho" id="2isbmywfozkwdmm2jgqk3" type="string"></arg></mutation><comment pinned="false" h="80" w="160">empty line =&gt; ACK with ?? and seq 00</comment><value name="8n45kask0p60lxbducz9j"><shadow type="math_number" id=":gWc]X6h#fv8BlysIQe%"><field name="NUM">0</field></shadow></value><value name="2isbmywfozkwdmm2jgqk3"><shadow type="text" id="r/s2jYST3;KOIm3XaTY!"><field name="TEXT">??</field></shadow></value><next><block type="function_return" id="JW=C,)PA)c/QNVUFt|M;"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="true"></mutation></block></next></block></statement><next><block type="variables_set" id="LV%r9dbVv`vaXSbtVsyp"><field name="VAR" id="COWuc3TIE?60EW4X+#S,">cmd</field><value name="VALUE"><shadow type="math_number" id="6+qY0KH.3?f1mA}tGic."><field name="NUM">0</field></shadow><block type="function_call_output" id="`fs%C!!=NrP4]A6rf~Vv"><mutation name="parseLine" functionid="cFh,B_uIPibZpiqFP56A"><arg name="line" id="2acdl58fzxudhfg9y5mo" type="string"></arg></mutation><value name="2acdl58fzxudhfg9y5mo"><shadow type="text" id="TAqq:eDJ$|PQ*%I;b?=O"><field name="TEXT">abc</field></shadow><block type="variables_get" id="(lx@zb*;n]Q+k[+yv$OQ"><field name="VAR" id="bFk@v:a#+pO,$T`.7%tw">line</field></block></value></block></value><next><block type="controls_if" id="egCP(BB[c!;qYj:V!rs-"><value name="IF0"><shadow type="logic_boolean" id="67{juS}--grW(JX(I9~O"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="kxrUc/zcMzA6:I{HQDL)"><value name="BOOL"><shadow type="logic_boolean" id=";ga4cjS?M$[%-rb[n[[z"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="mV|I8N2|_S_}`uP@1SaD"><field name="VAR" id="COWuc3TIE?60EW4X+#S,">cmd</field></block></value></block></value><statement name="DO0"><block type="variables_set" id="yaitOUo^PxLzDDiEP=[N"><field name="VAR" id="Z-TiCE@J_1c@9n4ab7[W">opGuess</field><comment pinned="false" h="80" w="160">Could not parse; try to guess OP for visibility</comment><value name="VALUE"><shadow type="math_number" id=")l0*?s4PUMXCu;[b:bEH"><field name="NUM">0</field></shadow><block type="function_call_output" id="OR0/SiKk~Ur?5}l$%+lI"><mutation name="guessOp" functionid="llRqwEVC19G$F`Z[Ks3B"><arg name="raw" id="qzeugosfwujrwtzlxdxn6" type="string"></arg></mutation><value name="qzeugosfwujrwtzlxdxn6"><shadow type="text" id="@z+g0-3kN0dlRlKb|#A-"><field name="TEXT">abc</field></shadow><block type="variables_get" id=".!F*`+M(h~cA9:2hm6bl"><field name="VAR" id="bFk@v:a#+pO,$T`.7%tw">line</field></block></value></block></value><next><block type="function_call" id="ZT@qG_VGyGWODNn#HH.;"><mutation name="sendAckWithOp" functionid="j)1IA5?|P,,WgXo;S}iT"><arg name="seq" id="8n45kask0p60lxbducz9j" type="number"></arg><arg name="opEcho" id="2isbmywfozkwdmm2jgqk3" type="string"></arg></mutation><value name="8n45kask0p60lxbducz9j"><shadow type="math_number" id="-0n8C9B7N$,P8Ou[]p/^"><field name="NUM">0</field></shadow></value><value name="2isbmywfozkwdmm2jgqk3"><shadow type="text" id="7$ao],E29)!a[=Fx+qTR"><field name="TEXT">abc</field></shadow><block type="variables_get" id=";]w4,=ccB{k]$PIYT*D("><field name="VAR" id="Z-TiCE@J_1c@9n4ab7[W">opGuess</field></block></value><next><block type="function_return" id=".IJE5(f_#Y$.pPH/cjxr"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="true"></mutation></block></next></block></next></block></statement><next><block type="typescript_statement" id="*GCWO}1K[5{IWIX_?/nE"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="runNow(cmd)" numlines="1"></mutation><next><block type="function_call" id="k+hq/@0qKT3hN:D2$)pm"><mutation name="sendAckWithOp" functionid="j)1IA5?|P,,WgXo;S}iT"><arg name="seq" id="8n45kask0p60lxbducz9j" type="number"></arg><arg name="opEcho" id="2isbmywfozkwdmm2jgqk3" type="string"></arg></mutation><comment pinned="false" h="80" w="160">ACK including the OP we executed</comment><value name="8n45kask0p60lxbducz9j"><shadow type="math_number" id="~s?Me^0_N0EM*xiR-_+e"><field name="NUM">1</field></shadow><block type="typescript_expression" id="q|c_a,a`fl3=r~K3*^fq"><field name="EXPRESSION">cmd.s</field></block></value><value name="2isbmywfozkwdmm2jgqk3"><shadow type="text" id="e!^OE(PDz*O}naRD,Opq"><field name="TEXT">abc</field></shadow><block type="typescript_expression" id="q~$l7t~C6:8nAAx^U/b#"><field name="EXPRESSION">(cmd.o &amp;&amp; cmd.o.length ? cmd.o : "??")</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>